import { Image, Notes, Head } from "mdx-deck";

import {
  CodeSurfer,
  CodeSurferColumns,
  Step,
} from "code-surfer";

import {
  vsDark as naiveTheme,
  nightOwl as smartTheme
} from "@code-surfer/themes"


import myTheme from './lib/theme'
export const theme = myTheme
//export const theme = smartTheme;

import beach from "./diagrams/beach.jpg";
import konyuhov1 from "./diagrams/konyuhov1.jpg";
import konyuhov2 from "./diagrams/konyuhov2.jpg";
import konyuhov3 from "./diagrams/konyuhov3.jpg";
import konyuhov4 from "./diagrams/konyuhov4.jpg";
import konyuhov5 from "./diagrams/konyuhov5.jpg";
import konyuhov6 from "./diagrams/konyuhov6.jpg";
import konyuhov61 from "./diagrams/konyuhov61.jpg";
import konyuhov7 from "./diagrams/konyuhov7.jpg";
import nakedInMountains from "./diagrams/nakedInMountains.jpg";
import modulesCosmicStation from "./diagrams/modulesCosmicStation.jpg";
 
import climbersBunch2 from "./diagrams/climbersBunch2.jpg";

import packagesClient0 from "./diagrams/packagesClient0.svg";
import packagesClient from "./diagrams/packagesClient.svg";
import packages from "./diagrams/packages.svg";
import packagesDependencies from "./diagrams/packagesDependencies.svg";
import packagesDependenciesFlowControl from "./diagrams/packagesDependenciesFlowControl.svg";

import layerModule from "./diagrams/layerModule.svg";
import layerModule1 from "./diagrams/layerModule1.svg";

import caLayerModulesBase from "./diagrams/caLayerModulesBase.svg";
import caLayerModulesBaseRequired from "./diagrams/caLayerModulesBaseRequired.svg";
import caLayerModulesBase1 from "./diagrams/caLayerModulesBase1.svg";
import caLayerModulesBase2 from "./diagrams/caLayerModulesBase2.svg";

import counterResetModule from "./diagrams/counterResetModule.svg";
import counterResetModuleImplementation from "./diagrams/counterResetModuleImplementation.svg";

import template from "./diagrams/template.svg";

<Head>
  <title>Стартер для Чистой Архитектуре</title>
</Head>

---

<p style="font-size: 150px; text-align:center; padding-bottom:200px;">
<snap  style="font-size: 100px">Стартер для</snap>
<br/>
Чистой Архитектуры
</p>

---

<p style="font-size: 100px; text-align:center; padding-bottom:140px;">
Главные свойства
</p>

---

- *Чистая Архитектура*

<Notes>

Из принципов *Чистой Архитектуры*, здесь представлены все, кроме *Liskov Substitution Principle*, для которого, как
минимум, нужно где-то использовать иерархию типов.

</Notes>

---

- *Чистая Архитектура*
- *React*

---

- *Чистая Архитектура*
- *React*
- *TypeScript*

---

- *Чистая Архитектура*
- *React*
- *TypeScript*
- *React Testing Library*

---

- *Чистая Архитектура*
- *React*
- *TypeScript*
- *React Testing Library*
- *REST API*

---

<p style="font-size: 130px; text-align:center; padding-bottom:140px;">
Правило зависимостей
<br/>
и модули
</p>

---

<Image src={modulesCosmicStation} style={{ width: '65vw', height: '950vh'}}/>

---

<Image src={packagesClient0} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

Здесь изображена структура директорий (packages) клиенского приложения, вполне обычная при разработке на принципах
Чистой Архитектуры.

- domain
  - entities
  - usecases
- ui
- adapters
  - presenters
  - gateways

Самое время дать пояснения используемым названиям.

</Notes>

---

<Image src={packagesClient} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

Здесь изображена структура директорий (packages) клиенского приложения, вполне обычная при разработке на принципах
Чистой Архитектуры.

- domain
  - entities
  - usecases
- ui
- adapters
  - presenters
  - gateways

</Notes>

---

<Image src={packages} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

Для полноты картины разместим на диаграмме серверную часть приложения

</Notes>

---

<Image src={packagesDependencies} style={{ width: '102vw', height: '100vh'}}/>

---

<Image src={packagesDependenciesFlowControl} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

Это вариант, когда сервис является частью приложения, его backend-составляющей. 

</Notes>

---

<Image src={layerModule} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

Модуль слоя в принципе обычный модуль. 

</Notes>

---

<Image src={layerModule1} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

... 

</Notes>

---

<Image src={caLayerModulesBase} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

... 

</Notes>

---

<Image src={caLayerModulesBaseRequired} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

... 

</Notes>

---

<Image src={caLayerModulesBase1} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

... 

</Notes>

---

<Image src={caLayerModulesBase2} style={{ width: '102vw', height: '100vh'}}/>

<Notes>

... 

</Notes>


---

<CodeSurferColumns themes={[naiveTheme, myTheme]}>

<Step>

<Image src={counterResetModule} style={{ width: '100vw', height: '100vh'}}/>

```ts 1:3,5:7 file=../../src/domain/usecases/CounterReset.ts title="CounterReset"
```

</Step>


<Step>

<Image src={counterResetModuleImplementation} style={{ width: '100vw', height: '100vh'}}/>

```ts 9:15 file=../../src/domain/usecases/CounterReset.ts title="CounterReset"
```

</Step>

</CodeSurferColumns>


<Notes>

В качестве примера приведём код бизнес-логики - из *usecases* - *CounterReset*

... 
</Notes>

---

<CodeSurferColumns themes={[myTheme]}>

<Step>

```ts file=../../src/index.tsx title="index.tsx"
```

</Step>

<Step>

```ts file=../../src/ui/App.tsx title="App.tsx"
```

</Step>

<Step>

```ts file=../../src/ui/Counter.tsx title="Counter.tsx"
```

</Step>

</CodeSurferColumns>

---

# СПАСИБО ЗА ВНИМАНИЕ!

---

[Alexander Lapygin](https://github.com/AlexanderLapygin)

---

# Исходники

[https://github.com/softspiders/ca-react-rest-api-starter](https://github.com/softspiders/ca-react-rest-api-starter)

---

# Полезные ссылки

[Презентация по *Принципу Инверсии Зависимостей*](https://github.com/softspiders/dip-in-ca-deck)

---

# Вспомогательные материалы

---

<Image src={template} style={{ width: '102vw', height: '100vh'}}/>

<Notes>
Это шаблон слайда с заголовком и подписью
</Notes>

---

<Image src={beach} style={{ width: '30vw', height: '80vh'}}/>

---

<Image src={konyuhov1} style={{ width: '30vw', height: '80vh'}}/>

---

<Image src={konyuhov2} style={{ width: '70vw', height: '70vh'}}/>

---

<Image src={konyuhov3} style={{ width: '55vw', height: '80vh'}}/>

---

<Image src={konyuhov4} style={{ width: '60vw', height: '80vh'}}/>

---

<Image src={konyuhov5} style={{ width: '70vw', height: '80vh'}}/>

---

<Image src={konyuhov61} style={{ width: '30vw', height: '80vh'}}/>

---

<Image src={konyuhov7} style={{ width: '30vw', height: '80vh'}}/>

---

<CodeSurferColumns themes={[naiveTheme, naiveTheme]}>

<Step>

<Image src={konyuhov1} style={{ width: '30vw', height: '80vh'}}/>

<Image src={konyuhov61} style={{ width: '30vw', height: '80vh'}}/>

</Step>

</CodeSurferColumns>

---

<Image src={nakedInMountains} style={{ width: '60vw', height: '80vh'}}/>

---

<Image src={climbersBunch2} style={{ width: '60vw', height: '80vh'}}/>

<Notes>

"Но мы выбираем трудный путь..."

На самом деле он оптимальный.

Что мы оптимизируем ?

Масштабирование во времени - устойчивость развития.

</Notes>

